var d=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var h=d((Nr,_)=>{var w="\x1B[0m",xe="\x1B[1m",qe="\x1B[31m",Ce="\x1B[33m",Se="\x1B[36m",Te="\x1B[2m",Re="\x1B[32m",M=`${xe}${qe}LifeScript error:${w}`,Ee=class{constructor(e,r,n){this.from=e,this.lineNumber=n,this.description=r}print(){if(this.from==="command"){console.log(M),console.error(`  ${this.description}${w}`);return}let e=`${Se}${this.from}${w}:${Ce}${this.lineNumber}${w}`;console.error(`${M} ${e}`),console.error(`  ${this.description}`),console.error(`${Te}  (check the line indicated in your file)${w}`)}static printCongratulations(){console.log(`${Re}No errors were found in your life-script file system.${w}`)}};_.exports=Ee});var b=d((qr,B)=>{var ke=class{static get rawArgsPostCommand(){return process.argv.slice(3)}constructor(e,r,n,t){this.commandName=e,this.description=r,this.example=n,this.needCongratulations=t}run(e){throw`Must implement Command "${this.commandName}" run method"`}cli(){throw`Must implement Command "${this.commandName}" cli method"`}};B.exports=ke});var H=d((Sr,U)=>{var O=b(),$e=h(),Fe=class extends O{constructor(...e){super("help","I need somebody: helps you remember the commands","life-script help"),this.commands=e,this.commands.unshift(this)}run(){console.log(`
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557`),console.log("\u2551                    \u{1F4DA} LIFE-SCRIPT COMMANDS                         \u2551"),console.log(`\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
`),this.commands.forEach(e=>{console.log("  \u250C\u2500 ",e.commandName),console.log("  \u2502  ",e.description),console.log("  \u2514\u2500 ","Example:",e.example),console.log()}),console.log("\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557"),console.log("\u2551  For more info visit: https://github.com/Gabrielito666/life-script \u2551"),console.log(`\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
`)}cli(){return O.rawArgsPostCommand.length>0?new $e("command","This command does not require arguments"):this.run()}};U.exports=Fe});var j=d((Rr,z)=>{var R=h(),Ae=H(),Y=class{static rawCommandName=process.argv[2];constructor(...e){e.unshift(new Ae(...e));for(let r of e)if(r.commandName===Y.rawCommandName){this.command=r;break}}async run(){if(!this.command)return new R("command","This is not a valid command. Please check out the documentation.");let e=await this.command.cli();if(e instanceof R)return e.print();if(this.command.needCongratulations)return R.printCongratulations()}};z.exports=Y});var y=d((kr,G)=>{var E=require("path"),Pe={filenames:{calendar:"calendar.txt",recurring:"recurring.txt",archive:".calendar-archive.txt"},absolute_paths:{"calendar.txt":E.resolve(process.env.LIFE_DIR,"calendar.txt"),"recurring.txt":E.resolve(process.env.LIFE_DIR,"recurring.txt"),".calendar-archive.txt":E.resolve(process.env.LIFE_DIR,".calendar-archive.txt")}};G.exports=Pe});var k=d(($r,K)=>{var W=require("fs"),J=h(),Ie=y(),Le=class{fromString(e,r){let n=e.split(`
`).map((a,o)=>({lineNumber:o+1,content:a.trim()})).filter(a=>a.content!==""),t=[],s={currentBlock:null};for(let a of n)if(a.content[0]!=="+"){let o={header:a,body:[]};t.push(o),s.currentBlock=o;continue}else{if(!s.currentBlock)return new J(r,"Blocks can't start with +",a.lineNumber);s.currentBlock.body.push(a);continue}return t}fromFilename(e){let r=Ie.absolute_paths[e];if(!W.existsSync(r))return new J(e,`~/life/${e} not exists, create it with touch`,0);let n=W.readFileSync(r,"utf-8");return this.fromString(n,e)}};K.exports=new Le});var q=d((Ar,Q)=>{var Me=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];Q.exports=Me});var v=d((Pr,X)=>{var _e=k(),p=h(),D=y(),V=q(),Be=e=>{let r=e.content.split(" ");if(r.length!==2)return new p(D.filenames.calendar,"a day calendar header must habe format: dd-mm-yy dayname",e.lineNumber);let[n,t]=r,s=n.split("-").map(f=>+f);if(s.length!==3||s.some(Number.isNaN))return new p(D.filenames.calendar,"a day calendar header must habe format: dd-mm-yy dayname",e.lineNumber);let[a,o,c]=s;if(a<1||a>31||o<1||o>12||!V.includes(t.toLowerCase().trim()))return new p(D.filenames.calendar,"a day calendar header must habe format: dd-mm-yy dayname",e.lineNumber);let u=new Date(c,o-1,a),i=V[u.getDay()];return t!==i?new p(D.filenames.calendar,"a day calendar header must habe format: dd-mm-yy dayname",e.lineNumber):u},Oe=()=>{let e=_e.fromFilename(D.filenames.calendar);if(e instanceof p)return e;let r=[];for(let n of e){let t=Be(n.header);if(t instanceof p)return t;let s=r[r.length-1];if(s&&s.date>=t)return new p(D.filenames.calendar,"The days are out of order or duplicated.",n.header.lineNumber);r.push({...n,date:t})}return r};X.exports=Oe});var $=d((Ir,ee)=>{var m=h(),Ue=k(),l=y(),Z=q(),g=class{constructor(e){this.tag=e}parse(e,r){throw new Error("RecurringTimeRule.match(date:Date) method must be implementated")}},He=class extends g{constructor(){super("@daily")}parse(e,r){return e.length!==0?new m(l.filenames.recurring,"@daily tags do not take arguments",r.lineNumber):n=>!0}},Ye=class extends g{constructor(){super("@weekly")}parse(e,r){let n=e[0]||"monday";return Z.includes(n)?t=>Z[t.date.getDay()]===n:new m(l.filenames.recurring,"The @weekly tags only accept days of the week as arguments. If no parameter is provided, Monday is assumed.",r.lineNumber)}},ze=class extends g{constructor(){super("@monthly")}parse(e,r){let n=e[0]?+e[0]:1;return Number.isNaN(n)||n<0||n>31?new m(l.filenames.recurring,"The @monthly tags only receive the number of the day of the month as an argument, or, failing that, no argument is assumed to be the 1st day.",r.lineNumber):t=>t.date.getDate()===n}},je=class extends g{constructor(){super("@yearly")}parse(e,r){let n=e[0]?e[0].split("-"):["1","1"];if(n.length!==2)return new m(l.filenames.recurring,"The @yearly tags only accept one argument in dd-mm format; otherwise, 1-1 is assumed.",r.lineNumber);let[t,s]=n.map(a=>+a);return[t,s].some(Number.isNaN)||t<1||t>31||s<1||s>12?new m(l.filenames.recurring,"The @yearly tags only accept one argument in dd-mm format; otherwise, 1-1 is assumed.",r.lineNumber):a=>a.date.getMonth()===s-1&&a.date.getDate()===t}},Ge=class extends g{constructor(){super("@unique")}parse(e,r){if(e.length!==1)return new m(l.filenames.recurring,"The @unique tags need one argument with dd-mm-yyyy format.");let n=e[0].split("-");if(n.length!==3)return new m(l.filenames.recurring,"The @unique tags only accept one argument in dd-mm-yyyy format.",r.lineNumber);let[t,s,a]=n.map(o=>+o);return[t,s,a].some(Number.isNaN)||t<1||t>31||s<1||s>12?new m(l.filenames.recurring,"The @unique tags only accept one argument in dd-mm-yyyy format.",r.lineNumber):o=>o.date.getFullYear()===a&&o.date.getMonth()===s-1&&o.date.getDate()===t}},We=class extends g{constructor(){super("@interval")}parse(e,r){if(e.length!==2)return new m(l.filenames.recurring,"The @interval tags need two arguments: 'dd-mm-yyyy [interval]. ex: 01-01-2025 2'",r.lineNumber);let n=e[0].split("-");if(n.length!==3)return new m(l.filenames.recurring,"The @interval tags only accept in the first argument: dd-mm-yyyy format.",r.lineNumber);let[t,s,a]=n.map(i=>+i);if([t,s,a].some(Number.isNaN)||t<1||t>31||s<1||s>12)return new m(l.filenames.recurring,"The @interval tags only accept in the first argument: dd-mm-yyyy format.",r.lineNumber);let o=+e[1];if(Number.isNaN(o))return new m(l.filenames.recurring,"The @interval tags should have a second arg with the number of days ferquency",r.lineNumber);let c=new Date;c.setFullYear(a),c.setMonth(s-1),c.setDate(t);let u=1e3*60*60*24;return i=>{let f=i.date-c;if(f<0)return!1;let x=f/u;return Math.floor(x)%o===0}}},Je=class extends g{constructor(){super("@comment")}parse(e,r){return()=>!1}},Ke=class{constructor(...e){this.rules=e}parse(e){let r=e.content.split(" ");for(let t of this.rules)if(t.tag===r[0])return t.parse(r.slice(1),e);let n=this.rules.map(t=>t.tag).join(", ");return new m("recurring",`The valid tags are: "${n}"`,e.lineNumber)}},Qe=new Ke(new He,new Ye,new ze,new je,new Ge,new We,new Je),Ve=()=>{let e=Ue.fromFilename(l.filenames.recurring);if(e instanceof m)return e;let r=[];for(let n of e){let t=Qe.parse(n.header);if(t instanceof m)return t;r.push({...n,checker:t})}return r};ee.exports=Ve});var te=d((jr,ne)=>{var Xe=v(),Ze=$(),C=h(),re=b(),er=require("fs"),rr=class extends re{constructor(){super("diagnostic","It diagnoses the syntax of the main life-script files.","life-script diagnostic",!0)}run(){if(!er.existsSync(process.env.LIFE_DIR))return new C("command","~/life dir not exists, create it with mkdir");let e=Xe();if(e instanceof C)return e;let r=Ze();if(r instanceof C)return r}cli(){return re.rawArgsPostCommand.length>0?new C("command","This command does not require any arguments."):this.run()}};ne.exports=rr});var ce=d((Wr,ie)=>{var F=require("fs").promises,se=y(),nr=v(),ae=h(),tr=q(),oe=b(),sr=e=>{let r=e.getDate(),n=e.getMonth()+1,t=e.getFullYear(),s=tr[e.getDay()];return`${r}-${n}-${t} ${s}`},ar=class extends oe{constructor(){super("add-calendar-days","Receive a number and add that number of days to the calendar.","life-script add-calendar-days 10")}async run(e){let r=nr();if(r instanceof ae)return r;let n=r.map(c=>c.date);if(n.length===0){let c=new Date,u=new Date(c);u.setDate(c.getDate()-1),n.push(u)}let t=n[n.length-1],s=Array.from({length:e},(c,u)=>{let i=new Date(t);return i.setDate(t.getDate()+u+1),i}).map(sr).join(`

`),a=se.absolute_paths[se.filenames.calendar];(await F.stat(a)).size>0&&await F.appendFile(a,`
`,"utf-8"),await F.appendFile(a,s,"utf-8")}cli(){let e=+oe.rawArgsPostCommand[0];return typeof e!="number"||Number.isNaN(e)||process.argv.length>4?new ae("command","The \u201Cadd-calendar-days\u201D command can only receive a numeric argument."):this.run(e)}};ie.exports=ar});var A=d((Kr,ue)=>{var or=e=>e.map(r=>[r.header.content,...r.body.map(n=>n.content)].join(`
`)).join(`

`);ue.exports=or});var he=d((Qr,fe)=>{var ir=v(),P=h(),S=require("fs").promises,me=require("fs"),T=y(),de=A(),le=b(),N=T.absolute_paths[T.filenames.archive],cr=T.absolute_paths[T.filenames.calendar],ur=class extends le{constructor(){super("archive-calendar","Archive past days in .calendar-archive.txt and delete them from the calendar.","life-script archive-calendar")}async run(){me.existsSync(N)||me.writeFileSync(N,"","utf-8");let e=ir();if(e instanceof P)return P;let r=[],n=[];for(let u of e){let i=new Date,f=new Date(i);f.setDate(i.getDate()-1),u.date<f?r.push(u):n.push(u)}let t=de(r),s=de(n);(await S.stat(N)).size>0&&await S.appendFile(N,`
`,"utf-8");let o=S.appendFile(N,t,"utf-8"),c=S.writeFile(cr,s.trim(),"utf-8");await Promise.all([o,c])}cli(){return le.rawArgsPostCommand.length>0?new P("command","This command does not require any arguments."):this.run()}};fe.exports=ur});var be=d((Xr,we)=>{var mr=require("fs").promises,ye=y(),dr=v(),lr=$(),I=h(),pe=A(),ge=b(),fr=class extends ge{constructor(){super("push-recurring","Add recurring events to the days on the calendar using the recurring.txt file as a template.","life-script push-recurring")}async run(){let e=dr();if(e instanceof I)return e;let r=lr();if(r instanceof I)return r;let n=[],t=[],s=new Date;s.setHours(0,0,0,0);for(let i of e)i<s?n.push(i):t.push(i);let a=t.map(i=>{let f={...i,body:[...i.body]};for(let x of r)x.checker(i)&&x.body.forEach(L=>{f.body.some(De=>{let ve=De.content.replace(/\[([x✓])\]/gi,"").replace(/\s+/g," ").trim(),Ne=L.content.replace(/\[([x✓])\]/gi,"").replace(/\s+/g," ").trim();return ve===Ne})||f.body.push(L)});return f}),o=pe(n),c=pe(a),u=o+`

`+c;await mr.writeFile(ye.absolute_paths[ye.filenames.calendar],u,"utf-8")}cli(){return ge.rawArgsPostCommand.length>0?new I("command","This command does not require any arguments."):this.run()}};we.exports=fr});var hr=j(),yr=te(),pr=ce(),gr=he(),wr=be(),br=new hr(new yr,new pr,new gr,new wr);br.run();
